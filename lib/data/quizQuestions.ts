// Quiz System Data Types and Questions

export type QuestionType = 'multiple-choice' | 'true-false' | 'fill-blank' | 'scenario'

export interface QuizQuestion {
  id: string
  lessonId?: string
  moduleId?: string
  type: QuestionType
  question: string
  points: number
  // For multiple-choice
  options?: string[]
  correctAnswer: string | string[]
  explanation?: string
  // For fill-blank (DAX formulas)
  placeholder?: string
  // For scenario questions
  scenario?: string
}

export interface Quiz {
  id: string
  title: string
  description: string
  quizType: 'lesson' | 'module' | 'mock-exam'
  associatedId?: string // lessonId or moduleId
  questions: QuizQuestion[]
  passingScore?: number // percentage
  timeLimit?: number // in minutes
  allowRetake?: boolean
}

export interface QuizAttempt {
  quizId: string
  startTime: number
  endTime?: number
  answers: Record<string, string | string[]>
  score: number
  passed: boolean
  completedAt: number
}

// Quiz questions for first 5 modules
export const quizData: Quiz[] = [
  // Module 0: Setting the Stage
  {
    id: 'module-0-assessment',
    title: 'Module 0: Course Foundations Assessment',
    description: 'Test your understanding of Business Intelligence fundamentals',
    quizType: 'module',
    associatedId: 'module-0',
    passingScore: 70,
    timeLimit: 20,
    allowRetake: true,
    questions: [
      {
        id: 'q-0-1',
        moduleId: 'module-0',
        type: 'multiple-choice',
        question: 'What is Business Intelligence (BI)?',
        points: 5,
        options: [
          'A process of creating static Excel spreadsheets',
          'The comprehensive process of transforming raw data into coherent, visually immersive, and interactive insights to drive informed business decisions',
          'A database management system',
          'A cloud storage service',
        ],
        correctAnswer: 'The comprehensive process of transforming raw data into coherent, visually immersive, and interactive insights to drive informed business decisions',
        explanation: 'BI is about transforming data into actionable insights that help drive business decisions through visualization and interactivity.',
      },
      {
        id: 'q-0-2',
        moduleId: 'module-0',
        type: 'true-false',
        question: 'Modern BI platforms like Power BI are designed to solve data volume, refresh, and collaboration limitations of traditional spreadsheets.',
        points: 3,
        correctAnswer: 'true',
        explanation: 'Power BI addresses scalability, automated refresh, and dynamic collaboration that Excel struggles with.',
      },
      {
        id: 'q-0-3',
        moduleId: 'module-0',
        type: 'multiple-choice',
        question: 'Which of the following is a key differentiator of this Power BI course?',
        points: 5,
        options: [
          'Focus on Excel only',
          'Real-world case study, AI/Copilot integration, Microsoft Fabric, and portfolio-ready capstones',
          'Basic chart creation only',
          'Theory without practice',
        ],
        correctAnswer: 'Real-world case study, AI/Copilot integration, Microsoft Fabric, and portfolio-ready capstones',
        explanation: 'This course emphasizes practical, real-world learning with modern features and portfolio development.',
      },
    ],
  },

  // Module 1: Power BI Ecosystem
  {
    id: 'module-1-assessment',
    title: 'Module 1: Power BI Ecosystem Assessment',
    description: 'Test your knowledge of Power BI components and setup',
    quizType: 'module',
    associatedId: 'module-1',
    passingScore: 70,
    timeLimit: 25,
    allowRetake: true,
    questions: [
      {
        id: 'q-1-1',
        moduleId: 'module-1',
        type: 'multiple-choice',
        question: 'What are the three main parts of the Power BI ecosystem?',
        points: 5,
        options: [
          'Desktop, Pro, and Premium',
          'Power BI Desktop, Power BI Service, and Power BI Mobile',
          'Excel, SQL, and Python',
          'Data, Model, and Visuals',
        ],
        correctAnswer: 'Power BI Desktop, Power BI Service, and Power BI Mobile',
        explanation: 'The three-part ecosystem consists of Desktop (authoring), Service (collaboration), and Mobile (consumption).',
      },
      {
        id: 'q-1-2',
        moduleId: 'module-1',
        type: 'multiple-choice',
        question: 'Which Power BI component is used for authoring and development?',
        points: 3,
        options: [
          'Power BI Service',
          'Power BI Mobile',
          'Power BI Desktop',
          'Power BI Gateway',
        ],
        correctAnswer: 'Power BI Desktop',
        explanation: 'Power BI Desktop is the free Windows application where all development happens.',
      },
      {
        id: 'q-1-3',
        moduleId: 'module-1',
        type: 'multiple-choice',
        question: 'How often is Power BI updated with new features?',
        points: 3,
        options: [
          'Annually',
          'Quarterly',
          'Monthly',
          'Never',
        ],
        correctAnswer: 'Monthly',
        explanation: 'Power BI is updated monthly with new features and improvements.',
      },
      {
        id: 'q-1-4',
        moduleId: 'module-1',
        type: 'true-false',
        question: 'Preview features in Power BI are automatically enabled by default.',
        points: 3,
        correctAnswer: 'false',
        explanation: 'Preview features must be manually enabled in File > Options and settings > Options > Preview features.',
      },
      {
        id: 'q-1-5',
        moduleId: 'module-1',
        type: 'multiple-choice',
        question: 'What are the three main views in Power BI Desktop?',
        points: 5,
        options: [
          'Data, Visuals, Settings',
          'Report View, Data View, and Model View',
          'Home, Insert, View',
          'Design, Code, Preview',
        ],
        correctAnswer: 'Report View, Data View, and Model View',
        explanation: 'Report View (visuals), Data View (spreadsheet inspection), and Model View (relationships) are the core views.',
      },
      {
        id: 'q-1-6',
        moduleId: 'module-1',
        type: 'multiple-choice',
        question: 'Power BI Desktop can run natively on which operating systems?',
        points: 4,
        options: [
          'Windows only',
          'Windows and Mac',
          'Windows, Mac, and Linux',
          'Cloud only',
        ],
        correctAnswer: 'Windows only',
        explanation: 'Power BI Desktop is Windows-only. Mac users need a virtual machine.',
      },
    ],
  },

  // Module 2: Data Acquisition
  {
    id: 'module-2-assessment',
    title: 'Module 2: Data Acquisition Assessment',
    description: 'Test your understanding of connecting to data sources',
    quizType: 'module',
    associatedId: 'module-2',
    passingScore: 70,
    timeLimit: 25,
    allowRetake: true,
    questions: [
      {
        id: 'q-2-1',
        moduleId: 'module-2',
        type: 'multiple-choice',
        question: 'What is the universal starting point for all Power BI projects?',
        points: 3,
        options: [
          'Create a blank report',
          'Add visuals',
          'Use the "Get Data" function',
          'Write DAX formulas',
        ],
        correctAnswer: 'Use the "Get Data" function',
        explanation: 'Get Data is where you start by connecting to your data sources.',
      },
      {
        id: 'q-2-2',
        moduleId: 'module-2',
        type: 'multiple-choice',
        question: 'Which file type can Power BI connect to?',
        points: 4,
        options: [
          'Excel only',
          'Excel, CSV, and PDF',
          'PowerPoint only',
          'Video files',
        ],
        correctAnswer: 'Excel, CSV, and PDF',
        explanation: 'Power BI supports Excel, CSV, PDF, and many other file formats.',
      },
      {
        id: 'q-2-3',
        moduleId: 'module-2',
        type: 'multiple-choice',
        question: 'In Connection Mode, which mode stores data inside the Power BI file?',
        points: 5,
        options: [
          'DirectQuery',
          'Import',
          'Composite',
          'Live Connection',
        ],
        correctAnswer: 'Import',
        explanation: 'Import mode copies and stores data in the .pbix file in a compressed format.',
      },
      {
        id: 'q-2-4',
        moduleId: 'module-2',
        type: 'scenario',
        scenario: 'You need to analyze sales data from a SQL Server database that updates every hour. The database is on-premises.',
        question: 'Which connection mode would be most appropriate?',
        points: 6,
        options: [
          'Import mode for faster performance',
          'DirectQuery mode for real-time data',
          'Composite mode',
          'Either Import or DirectQuery works',
        ],
        correctAnswer: 'DirectQuery mode for real-time data',
        explanation: 'DirectQuery sends queries directly to the source database for real-time data, perfect for frequently updating data.',
      },
      {
        id: 'q-2-5',
        moduleId: 'module-2',
        type: 'true-false',
        question: 'DirectQuery mode provides faster report performance than Import mode.',
        points: 4,
        correctAnswer: 'false',
        explanation: 'Import mode is faster because data is pre-loaded and stored. DirectQuery queries the source database each time.',
      },
      {
        id: 'q-2-6',
        moduleId: 'module-2',
        type: 'multiple-choice',
        question: 'What is the key difference between Import and DirectQuery modes?',
        points: 5,
        options: [
          'Import is free, DirectQuery costs money',
          'Import stores data in Power BI, DirectQuery queries the source',
          'Import is cloud-only, DirectQuery is on-premises only',
          'There is no difference',
        ],
        correctAnswer: 'Import stores data in Power BI, DirectQuery queries the source',
        explanation: 'Import copies data into Power BI, while DirectQuery sends queries to the source database.',
      },
    ],
  },

  // Module 3: Power Query
  {
    id: 'module-3-assessment',
    title: 'Module 3: Data Transformation Assessment',
    description: 'Test your Power Query knowledge',
    quizType: 'module',
    associatedId: 'module-3',
    passingScore: 75,
    timeLimit: 30,
    allowRetake: true,
    questions: [
      {
        id: 'q-3-1',
        moduleId: 'module-3',
        type: 'multiple-choice',
        question: 'What is the best practice when connecting to data in Power BI?',
        points: 3,
        options: [
          'Always click "Load" immediately',
          'Always click "Transform" first',
          'Load without reviewing',
          'Skip preview',
        ],
        correctAnswer: 'Always click "Transform" first',
        explanation: 'Always select Transform to clean and prepare data before loading.',
      },
      {
        id: 'q-3-2',
        moduleId: 'module-3',
        type: 'multiple-choice',
        question: 'What does ETL stand for?',
        points: 3,
        options: [
          'Extract, Transform, Load',
          'Excel, Table, List',
          'Export, Transfer, Locate',
          'Edit, Test, Launch',
        ],
        correctAnswer: 'Extract, Transform, Load',
        explanation: 'ETL is the core process: Extract data, Transform it, Load it into the model.',
      },
      {
        id: 'q-3-3',
        moduleId: 'module-3',
        type: 'multiple-choice',
        question: 'What is the primary benefit of the Applied Steps pane in Power Query?',
        points: 5,
        options: [
          'It shows file size',
          'Every transformation is recorded and replayed automatically on refresh',
          'It exports to Excel',
          'It calculates measures',
        ],
        correctAnswer: 'Every transformation is recorded and replayed automatically on refresh',
        explanation: 'Applied Steps make data cleaning automated and repeatable.',
      },
      {
        id: 'q-3-4',
        moduleId: 'module-3',
        type: 'true-false',
        question: 'Unpivot transforms wide data (columns for each month) into tall data (one Month column, one Value column).',
        points: 4,
        correctAnswer: 'true',
        explanation: 'Unpivot is crucial for converting spreadsheet-style wide data into tidy tall format.',
      },
      {
        id: 'q-3-5',
        moduleId: 'module-3',
        type: 'multiple-choice',
        question: 'What is the key difference between Append and Merge operations?',
        points: 6,
        options: [
          'Append combines vertically (more rows), Merge combines horizontally (more columns)',
          'Append combines horizontally, Merge combines vertically',
          'They are the same operation',
          'Append is for Excel, Merge is for databases',
        ],
        correctAnswer: 'Append combines vertically (more rows), Merge combines horizontally (more columns)',
        explanation: 'Append stacks data, Merge joins columns. Think Append = rows, Merge = VLOOKUP.',
      },
      {
        id: 'q-3-6',
        moduleId: 'module-3',
        type: 'scenario',
        scenario: 'You have sales data with columns: Jan, Feb, Mar. You need to analyze monthly trends in Power BI.',
        question: 'What operation should you use?',
        points: 6,
        options: [
          'Pivot',
          'Unpivot',
          'Group By',
          'Split Column',
        ],
        correctAnswer: 'Unpivot',
        explanation: 'Unpivot converts the wide format (separate columns for each month) into tall format (one Month column, one Value column) which is needed for time-series analysis.',
      },
      {
        id: 'q-3-7',
        moduleId: 'module-3',
        type: 'multiple-choice',
        question: 'What language does Power Query use under the hood?',
        points: 4,
        options: [
          'DAX',
          'Python',
          'M',
          'SQL',
        ],
        correctAnswer: 'M',
        explanation: 'Power Query uses the M language (functional programming language).',
      },
      {
        id: 'q-3-8',
        moduleId: 'module-3',
        type: 'true-false',
        question: 'Power Query transformations are destructive - you cannot undo them.',
        points: 3,
        correctAnswer: 'false',
        explanation: 'Power Query is non-destructive. You can edit, reorder, or delete any applied step at any time.',
      },
    ],
  },

  // Module 4: Data Visualization
  {
    id: 'module-4-assessment',
    title: 'Module 4: Data Visualization Assessment',
    description: 'Test your knowledge of creating reports and visuals',
    quizType: 'module',
    associatedId: 'module-4',
    passingScore: 75,
    timeLimit: 25,
    allowRetake: true,
    questions: [
      {
        id: 'q-4-1',
        moduleId: 'module-4',
        type: 'multiple-choice',
        question: 'What is the core workflow for building a report?',
        points: 4,
        options: [
          'Write DAX first, then add visuals',
          'Select a visual type, then drag fields from Fields pane into visual wells',
          'Import data, then export to Excel',
          'Create dashboard, then add data',
        ],
        correctAnswer: 'Select a visual type, then drag fields from Fields pane into visual wells',
        explanation: 'The basic workflow is: choose a visual type, then populate it with data fields.',
      },
      {
        id: 'q-4-2',
        moduleId: 'module-4',
        type: 'multiple-choice',
        question: 'Which visual is best for showing categorical comparisons?',
        points: 3,
        options: [
          'Line chart',
          'Bar/Column chart',
          'Pie chart',
          'Map',
        ],
        correctAnswer: 'Bar/Column chart',
        explanation: 'Bar/Column charts are ideal for comparing categories (e.g., Sales by Category).',
      },
      {
        id: 'q-4-3',
        moduleId: 'module-4',
        type: 'multiple-choice',
        question: 'What is a Slicer used for?',
        points: 4,
        options: [
          'To delete data',
          'As an on-page visual filter that allows end-users to interact with and filter the report',
          'To export reports',
          'To calculate measures',
        ],
        correctAnswer: 'As an on-page visual filter that allows end-users to interact with and filter the report',
        explanation: 'Slicers provide interactive filtering for the entire report page.',
      },
      {
        id: 'q-4-4',
        moduleId: 'module-4',
        type: 'multiple-choice',
        question: 'What visual displays a single number most prominently?',
        points: 3,
        options: [
          'Bar chart',
          'Card',
          'Map',
          'Table',
        ],
        correctAnswer: 'Card',
        explanation: 'Card visuals display a single, prominent number (like Total Sales).',
      },
      {
        id: 'q-4-5',
        moduleId: 'module-4',
        type: 'scenario',
        scenario: 'You need to show how Sales and Profit have changed over the past 12 months.',
        question: 'Which visual type would be most appropriate?',
        points: 5,
        options: [
          'Pie chart',
          'Line chart',
          'Gauge',
          'Slicer',
        ],
        correctAnswer: 'Line chart',
        explanation: 'Line charts are ideal for showing trends over time.',
      },
      {
        id: 'q-4-6',
        moduleId: 'module-4',
        type: 'true-false',
        question: 'Applying a report theme ensures consistent colors and fonts across all visuals on a page.',
        points: 3,
        correctAnswer: 'true',
        explanation: 'Report themes provide consistent styling across the entire report.',
      },
      {
        id: 'q-4-7',
        moduleId: 'module-4',
        type: 'multiple-choice',
        question: 'What is the recommended way to highlight the most important information in a report?',
        points: 4,
        options: [
          'Use as many colors as possible',
          'Place KPIs in the top-left using visual hierarchy',
          'Make everything the same size',
          'Hide data',
        ],
        correctAnswer: 'Place KPIs in the top-left using visual hierarchy',
        explanation: 'Users read in a "Z" pattern, so place important info in the top-left.',
      },
      {
        id: 'q-4-8',
        moduleId: 'module-4',
        type: 'true-false',
        question: 'Report formatting is just decoration - it has no impact on usability.',
        points: 4,
        correctAnswer: 'false',
        explanation: 'Good design guides the user\'s eye and makes insights easier to understand. It\'s critical for effective communication.',
      },
    ],
  },

  // Capstone 1 Quiz
  {
    id: 'capstone-1-quiz',
    title: 'Capstone 1: Beginner Report Quiz',
    description: 'Validate your understanding before starting the first capstone',
    quizType: 'module',
    associatedId: 'capstone-1',
    passingScore: 80,
    timeLimit: 20,
    allowRetake: true,
    questions: [
      {
        id: 'cap-1-1',
        moduleId: 'capstone-1',
        type: 'multiple-choice',
        question: 'What is the first task in building an end-to-end report?',
        points: 5,
        options: [
          'Creating visuals',
          'Connecting to data (Get Data)',
          'Writing DAX',
          'Designing themes',
        ],
        correctAnswer: 'Connecting to data (Get Data)',
        explanation: 'Always start by getting data, then transform, then visualize.',
      },
      {
        id: 'cap-1-2',
        moduleId: 'capstone-1',
        type: 'true-false',
        question: 'The complete BI workflow is: Get -> Transform -> Visualize',
        points: 3,
        correctAnswer: 'true',
        explanation: 'This three-step workflow is the foundation of all BI development.',
      },
    ],
  },

  // PL-300 Mock Exam
  {
    id: 'pl300-mock-exam',
    title: 'PL-300 Certification Mock Exam',
    description: 'Comprehensive practice exam covering all PL-300: Microsoft Power BI Data Analyst domains',
    quizType: 'mock-exam',
    passingScore: 70,
    timeLimit: 100, // 100 minutes like the real exam
    allowRetake: true,
    questions: [
      {
        id: 'pl300-1',
        type: 'multiple-choice',
        question: 'Which of the following is the primary purpose of Power Query?',
        points: 5,
        options: [
          'Writing DAX formulas',
          'Creating visualizations',
          'Transforming and cleaning data',
          'Publishing reports to the Service',
        ],
        correctAnswer: 'Transforming and cleaning data',
        explanation: 'Power Query is the ETL (Extract, Transform, Load) tool for data transformation and cleaning.',
      },
      {
        id: 'pl300-2',
        type: 'multiple-choice',
        question: 'What is the recommended data model design pattern for Power BI?',
        points: 5,
        options: [
          'Snowflake schema',
          'Star schema',
          'Normalized schema',
          'Flat file schema',
        ],
        correctAnswer: 'Star schema',
        explanation: 'The star schema is the gold standard for Power BI data models, with a central fact table and dimension tables.',
      },
      {
        id: 'pl300-3',
        type: 'multiple-choice',
        question: 'When should you use a Calculated Column vs. a Measure?',
        points: 6,
        options: [
          'Always use Calculated Columns for better performance',
          'Always use Measures for aggregations in visuals',
          'Use Calculated Columns for slicers and Measures for aggregations',
          'They are interchangeable',
        ],
        correctAnswer: 'Use Calculated Columns for slicers and Measures for aggregations',
        explanation: 'Calculated Columns are for row-level categorization and slicers. Measures are for aggregations at query time.',
      },
      {
        id: 'pl300-4',
        type: 'fill-blank',
        question: 'Complete this DAX measure: Total Sales = _____(Sales[SalesAmount])',
        points: 5,
        placeholder: 'Enter function name...',
        correctAnswer: 'sum',
        explanation: 'SUM() is the basic aggregation function. Could also use SUMX for row-by-row calculations.',
      },
      {
        id: 'pl300-5',
        type: 'multiple-choice',
        question: 'What is the most powerful DAX function for modifying filter context?',
        points: 6,
        options: [
          'SUMX',
          'CALCULATE',
          'RELATED',
          'FILTER',
        ],
        correctAnswer: 'CALCULATE',
        explanation: 'CALCULATE is the most important DAX function as it modifies filter context.',
      },
      {
        id: 'pl300-6',
        type: 'true-false',
        question: 'You can use DAX Time Intelligence functions without a dedicated Date table.',
        points: 4,
        correctAnswer: 'false',
        explanation: 'Time Intelligence functions require a properly formatted Date table that is marked as a Date table.',
      },
      {
        id: 'pl300-7',
        type: 'scenario',
        scenario: 'You have a dataset with 100 million rows and need real-time data updates. Your reports will be accessed by 10 users simultaneously.',
        question: 'Which connection mode should you use?',
        points: 7,
        options: [
          'Import mode',
          'DirectQuery mode',
          'Live Connection mode',
          'Either Import or DirectQuery',
        ],
        correctAnswer: 'DirectQuery mode',
        explanation: 'DirectQuery is ideal for large datasets and real-time requirements, though performance depends on the source.',
      },
      {
        id: 'pl300-8',
        type: 'multiple-choice',
        question: 'What is Row-Level Security (RLS) used for?',
        points: 5,
        options: [
          'Controlling visual access',
          'Restricting data visibility at the row level based on user identity',
          'Limiting report size',
          'Performance optimization',
        ],
        correctAnswer: 'Restricting data visibility at the row level based on user identity',
        explanation: 'RLS ensures users only see data they are authorized to see based on their identity.',
      },
      {
        id: 'pl300-9',
        type: 'multiple-choice',
        question: 'In the Power BI Service, what is the difference between a Report and a Dashboard?',
        points: 6,
        options: [
          'Reports are in Desktop, Dashboards are in Service',
          'Reports are interactive multi-page analysis; Dashboards are single-page monitoring views',
          'They are the same thing',
          'Dashboards contain DAX, Reports do not',
        ],
        correctAnswer: 'Reports are interactive multi-page analysis; Dashboards are single-page monitoring views',
        explanation: 'Reports are for deep analysis with interactivity. Dashboards are static monitoring views.',
      },
      {
        id: 'pl300-10',
        type: 'multiple-choice',
        question: 'Which tool should you use to diagnose slow DAX query performance?',
        points: 5,
        options: [
          'Performance Analyzer',
          'DAX Studio',
          'Tabular Editor',
          'Both Performance Analyzer and DAX Studio',
        ],
        correctAnswer: 'Both Performance Analyzer and DAX Studio',
        explanation: 'Performance Analyzer identifies which visual is slow; DAX Studio shows why the DAX query is slow.',
      },
      {
        id: 'pl300-11',
        type: 'true-false',
        question: 'Report themes can be applied to ensure consistent colors and fonts across visuals.',
        points: 3,
        correctAnswer: 'true',
        explanation: 'Applying a report theme maintains design consistency across the entire report.',
      },
      {
        id: 'pl300-12',
        type: 'multiple-choice',
        question: 'What is the primary advantage of using Microsoft Fabric with Power BI?',
        points: 5,
        options: [
          'Lower cost',
          'Faster refresh',
          'Unified data lake (OneLake) eliminating data silos',
          'Better visuals',
        ],
        correctAnswer: 'Unified data lake (OneLake) eliminating data silos',
        explanation: 'Fabric provides a unified data platform where all tools share OneLake, eliminating data duplication.',
      },
      {
        id: 'pl300-13',
        type: 'scenario',
        scenario: 'You need to grant a user access to only see sales data for the "East" region. All other users should see all regions.',
        question: 'Which RLS approach is most scalable?',
        points: 7,
        options: [
          'Static RLS with a role per region',
          'Dynamic RLS with a user permissions table',
          'No RLS, just hide the visual',
          'Share only East region reports',
        ],
        correctAnswer: 'Dynamic RLS with a user permissions table',
        explanation: 'Dynamic RLS is scalable as you add more users by simply adding rows to the permissions table.',
      },
      {
        id: 'pl300-14',
        type: 'multiple-choice',
        question: 'What is an Aggregation table used for?',
        points: 6,
        options: [
          'Organizing data alphabetically',
          'Pre-summarizing large fact tables for better performance',
          'Grouping columns',
          'Importing data',
        ],
        correctAnswer: 'Pre-summarizing large fact tables for better performance',
        explanation: 'Aggregations pre-calculate summaries for faster query performance while maintaining detail on drill-down.',
      },
      {
        id: 'pl300-15',
        type: 'fill-blank',
        question: 'Complete this Time Intelligence measure: Sales YTD = _____([Total Sales], \'Date\'[Date])',
        points: 5,
        placeholder: 'Enter function name...',
        correctAnswer: 'totalytd',
        explanation: 'TOTALYTD calculates year-to-date totals, a common Time Intelligence pattern.',
      },
      {
        id: 'pl300-16',
        type: 'multiple-choice',
        question: 'Which DAX pattern correctly calculates % of Total Sales?',
        points: 6,
        options: [
          'DIVIDE([Total Sales], SUM(Sales))',
          'DIVIDE([Total Sales], CALCULATE([Total Sales], ALL()))',
          'DIVIDE([Total Sales], [Total Sales])',
          '[Total Sales] / 100',
        ],
        correctAnswer: 'DIVIDE([Total Sales], CALCULATE([Total Sales], ALL()))',
        explanation: 'CALCULATE with ALL() removes filters to get the grand total. DIVIDE handles divide-by-zero safely.',
      },
      {
        id: 'pl300-17',
        type: 'true-false',
        question: 'DirectQuery mode provides faster report performance than Import mode.',
        points: 4,
        correctAnswer: 'false',
        explanation: 'Import mode is typically faster as data is pre-loaded. DirectQuery queries the source each time.',
      },
      {
        id: 'pl300-18',
        type: 'multiple-choice',
        question: 'What is the purpose of Deployment Pipelines in Power BI Service?',
        points: 6,
        options: [
          'Managing report versions',
          'Automating the CI/CD process for safe deployments to production',
          'Importing data',
          'Creating visuals',
        ],
        correctAnswer: 'Automating the CI/CD process for safe deployments to production',
        explanation: 'Deployment Pipelines enable DEV -> TEST -> PROD workflow to prevent broken reports reaching end-users.',
      },
      {
        id: 'pl300-19',
        type: 'multiple-choice',
        question: 'What are Calculation Groups used for?',
        points: 7,
        options: [
          'Grouping multiple tables',
          'Creating reusable time intelligence calculations',
          'Organizing visuals',
          'Merging queries',
        ],
        correctAnswer: 'Creating reusable time intelligence calculations',
        explanation: 'Calculation Groups are "measures for measures" - reusable logic applied to any base measure.',
      },
      {
        id: 'pl300-20',
        type: 'scenario',
        scenario: 'Your organization has sensitive financial data that must be hidden from most analysts. Managers need access.',
        question: 'Which security feature should you implement?',
        points: 7,
        options: [
          'RLS only',
          'RLS to hide rows, OLS to hide columns',
          'Workspace permissions only',
          'Report-level filters',
        ],
        correctAnswer: 'RLS to hide rows, OLS to hide columns',
        explanation: 'RLS hides rows. Object-Level Security (OLS) hides specific columns/tables from certain roles.',
      },
    ],
  },

  // Module 5: Data Modeling
  {
    id: 'module-5-assessment',
    title: 'Module 5: Data Modeling Assessment',
    description: 'Test your understanding of star schemas and data modeling',
    quizType: 'module',
    associatedId: 'module-5',
    passingScore: 70,
    timeLimit: 25,
    allowRetake: true,
    questions: [
      {
        id: 'q-5-1',
        moduleId: 'module-5',
        type: 'multiple-choice',
        question: 'Why is data modeling considered the most critical skill in Power BI?',
        points: 5,
        options: [
          'It makes reports look prettier',
          'A proper data model is the most important form of performance tuning',
          'It reduces file size only',
          'Models are optional in Power BI',
        ],
        correctAnswer: 'A proper data model is the most important form of performance tuning',
        explanation: 'Data modeling directly impacts performance. A good star schema model is fast, efficient, and makes writing DAX simple.',
      },
      {
        id: 'q-5-2',
        moduleId: 'module-5',
        type: 'multiple-choice',
        question: 'What are the two primary types of tables in a data model?',
        points: 4,
        options: [
          'Primary and secondary tables',
          'Fact and Dimension tables',
          'Main and lookup tables',
          'Source and target tables',
        ],
        correctAnswer: 'Fact and Dimension tables',
        explanation: 'Fact tables store transactions and measures; Dimension tables store descriptive context.',
      },
      {
        id: 'q-5-3',
        moduleId: 'module-5',
        type: 'true-false',
        question: 'Fact tables are typically "long and narrow" while Dimension tables are "short and wide".',
        points: 4,
        correctAnswer: 'true',
        explanation: 'Fact tables have many rows (transactions); Dimension tables have many columns (attributes) but fewer rows.',
      },
      {
        id: 'q-5-4',
        moduleId: 'module-5',
        type: 'multiple-choice',
        question: 'Which data model design pattern is considered the "gold standard" for Power BI?',
        points: 5,
        options: [
          'Normalized schema',
          'Star schema',
          'Snowflake schema',
          'Flat file schema',
        ],
        correctAnswer: 'Star schema',
        explanation: 'The star schema with a central fact table surrounded by dimension tables is optimized for Power BI\'s VertiPaq engine.',
      },
      {
        id: 'q-5-5',
        moduleId: 'module-5',
        type: 'multiple-choice',
        question: 'What is the most common cardinality type for relationships in Power BI?',
        points: 4,
        options: [
          'One-to-One (1:1)',
          'One-to-Many (1:*)',
          'Many-to-Many (*:*)',
          'Both-to-Both',
        ],
        correctAnswer: 'One-to-Many (1:*)',
        explanation: 'One-to-Many is the ideal and most common type, where one dimension record relates to many fact records.',
      },
      {
        id: 'q-5-6',
        moduleId: 'module-5',
        type: 'scenario',
        scenario: 'You have a date dimension table that needs to filter sales on both Order Date and Ship Date.',
        question: 'What advanced modeling concept would you use?',
        points: 6,
        options: [
          'Create two separate date tables',
          'Create a role-playing dimension with inactive relationships',
          'Merge all dates into the fact table',
          'Use DirectQuery instead',
        ],
        correctAnswer: 'Create a role-playing dimension with inactive relationships',
        explanation: 'Role-playing dimensions allow one table to serve multiple purposes using active and inactive relationships.',
      },
    ],
  },

  // Module 6: Introduction to DAX
  {
    id: 'module-6-assessment',
    title: 'Module 6: Introduction to DAX Assessment',
    description: 'Test your understanding of DAX fundamentals',
    quizType: 'module',
    associatedId: 'module-6',
    passingScore: 75,
    timeLimit: 30,
    allowRetake: true,
    questions: [
      {
        id: 'q-6-1',
        moduleId: 'module-6',
        type: 'multiple-choice',
        question: 'What does DAX stand for?',
        points: 3,
        options: [
          'Data Analytics Expression',
          'Data Analysis Expressions',
          'Dynamic Analytics XML',
          'Database Access XML',
        ],
        correctAnswer: 'Data Analysis Expressions',
        explanation: 'DAX is the formula language for Power BI, SSAS Tabular, and Power Pivot.',
      },
      {
        id: 'q-6-2',
        moduleId: 'module-6',
        type: 'multiple-choice',
        question: 'What is the primary difference between Calculated Columns and Measures?',
        points: 6,
        options: [
          'Columns are for text, Measures are for numbers',
          'Columns are evaluated at refresh (row context), Measures at query time (filter context)',
          'Columns are faster, Measures are slower',
          'They are identical',
        ],
        correctAnswer: 'Columns are evaluated at refresh (row context), Measures at query time (filter context)',
        explanation: 'This is the most critical DAX concept: columns use row context and store results; measures use filter context and calculate on-the-fly.',
      },
      {
        id: 'q-6-3',
        moduleId: 'module-6',
        type: 'multiple-choice',
        question: 'When should you use a Calculated Column instead of a Measure?',
        points: 5,
        options: [
          'Always use columns for better performance',
          'When you need the result in a slicer, on an axis, or as a filter',
          'Only for simple calculations',
          'Never use calculated columns',
        ],
        correctAnswer: 'When you need the result in a slicer, on an axis, or as a filter',
        explanation: 'The golden rule: use columns only when necessary (for slicers/filters), use measures for aggregations.',
      },
      {
        id: 'q-6-4',
        moduleId: 'module-6',
        type: 'fill-blank',
        question: 'Complete this DAX measure: Total Sales = _____([SalesAmount])',
        points: 4,
        placeholder: 'Enter function name...',
        correctAnswer: 'sum',
        explanation: 'SUM() is the basic aggregation function for measures.',
      },
      {
        id: 'q-6-5',
        moduleId: 'module-6',
        type: 'true-false',
        question: 'Implicit measures (auto-generated) should always be disabled in favor of explicit measures.',
        points: 4,
        correctAnswer: 'true',
        explanation: 'Professional developers create explicit measures for better control, reusability, and clarity.',
      },
      {
        id: 'q-6-6',
        moduleId: 'module-6',
        type: 'multiple-choice',
        question: 'What does Quick Measures provide?',
        points: 4,
        options: [
          'Faster report loading',
          'Pre-built DAX templates generated by Power BI',
          'Automatic data refresh',
          'Performance optimization',
        ],
        correctAnswer: 'Pre-built DAX templates generated by Power BI',
        explanation: 'Quick Measures auto-generate DAX code for common calculations like running totals.',
      },
    ],
  },

  // Module 7: Intermediate DAX
  {
    id: 'module-7-assessment',
    title: 'Module 7: Intermediate DAX Assessment',
    description: 'Test your understanding of evaluation context and iterators',
    quizType: 'module',
    associatedId: 'module-7',
    passingScore: 75,
    timeLimit: 30,
    allowRetake: true,
    questions: [
      {
        id: 'q-7-1',
        moduleId: 'module-7',
        type: 'multiple-choice',
        question: 'What are the two types of evaluation context in DAX?',
        points: 5,
        options: [
          'Current and previous context',
          'Row context and Filter context',
          'Column context and measure context',
          'Context and no context',
        ],
        correctAnswer: 'Row context and Filter context',
        explanation: 'Row context iterates row-by-row; Filter context applies filters before calculation.',
      },
      {
        id: 'q-7-2',
        moduleId: 'module-7',
        type: 'multiple-choice',
        question: 'Where does Row Context exist by default?',
        points: 4,
        options: [
          'In all DAX measures',
          'In calculated columns',
          'In queries only',
          'Never exists',
        ],
        correctAnswer: 'In calculated columns',
        explanation: 'Row context is the default context in calculated columns, iterating through each row.',
      },
      {
        id: 'q-7-3',
        moduleId: 'module-7',
        type: 'multiple-choice',
        question: 'What does Filter Context represent?',
        points: 5,
        options: [
          'The current row being processed',
          'All filters applied before a measure is calculated',
          'The visual formatting',
          'Data refresh settings',
        ],
        correctAnswer: 'All filters applied before a measure is calculated',
        explanation: 'Filter context includes slicers, filters, and visual coordinates that affect measure calculation.',
      },
      {
        id: 'q-7-4',
        moduleId: 'module-7',
        type: 'multiple-choice',
        question: 'What are "X-functions" or iterators?',
        points: 5,
        options: [
          'Functions that create explicit measures',
          'Functions that create row context within a measure',
          'Functions that only work in columns',
          'Obsolete DAX functions',
        ],
        correctAnswer: 'Functions that create row context within a measure',
        explanation: 'Iterators like SUMX, AVERAGEX create row context to iterate and calculate row-by-row.',
      },
      {
        id: 'q-7-5',
        moduleId: 'module-7',
        type: 'scenario',
        scenario: 'You need to calculate Total Sales = Quantity × UnitPrice for each row, then sum them.',
        question: 'Which DAX pattern should you use?',
        points: 6,
        options: [
          'SUM(Sales[Quantity * UnitPrice])',
          'SUMX(Sales, Sales[Quantity] * Sales[UnitPrice])',
          'SUM(Sales[Quantity]) * SUM(Sales[UnitPrice])',
          'AVERAGE(Sales[Quantity * UnitPrice])',
        ],
        correctAnswer: 'SUMX(Sales, Sales[Quantity] * Sales[UnitPrice])',
        explanation: 'SUMX creates row context to multiply each row first, then sum. This is the correct pattern for row-by-row calculation.',
      },
      {
        id: 'q-7-6',
        moduleId: 'module-7',
        type: 'true-false',
        question: 'Using iterator functions (like SUMX) is always slower than using aggregation functions (like SUM).',
        points: 5,
        correctAnswer: 'false',
        explanation: 'Iterators are powerful and appropriate when you need row-by-row logic. They are not inherently slower when used correctly.',
      },
    ],
  },

  // Module 8: Advanced DAX
  {
    id: 'module-8-assessment',
    title: 'Module 8: Advanced DAX Assessment',
    description: 'Test your mastery of CALCULATE and filter context',
    quizType: 'module',
    associatedId: 'module-8',
    passingScore: 75,
    timeLimit: 35,
    allowRetake: true,
    questions: [
      {
        id: 'q-8-1',
        moduleId: 'module-8',
        type: 'multiple-choice',
        question: 'What is the most important function in DAX?',
        points: 5,
        options: [
          'SUMX',
          'CALCULATE',
          'FILTER',
          'RELATED',
        ],
        correctAnswer: 'CALCULATE',
        explanation: 'CALCULATE is the most powerful and important DAX function—it modifies filter context.',
      },
      {
        id: 'q-8-2',
        moduleId: 'module-8',
        type: 'multiple-choice',
        question: 'What is the primary purpose of CALCULATE?',
        points: 5,
        options: [
          'To create calculated columns',
          'To modify the filter context',
          'To improve performance',
          'To add text formatting',
        ],
        correctAnswer: 'To modify the filter context',
        explanation: 'CALCULATE is the only DAX function that can modify filter context.',
      },
      {
        id: 'q-8-3',
        moduleId: 'module-8',
        type: 'fill-blank',
        question: 'Complete this DAX measure to calculate sales for only the East region: East Sales = CALCULATE([Total Sales], _____)',
        points: 5,
        placeholder: 'Enter filter expression...',
        correctAnswer: 'Region = "East"',
        explanation: 'CALCULATE adds new filters as additional arguments.',
      },
      {
        id: 'q-8-4',
        moduleId: 'module-8',
        type: 'multiple-choice',
        question: 'What does the ALL() function do?',
        points: 5,
        options: [
          'Returns all rows without errors',
          'Removes filters from a table or column',
          'Sums all values',
          'Creates relationships',
        ],
        correctAnswer: 'Removes filters from a table or column',
        explanation: 'ALL() is primarily used inside CALCULATE to remove filters.',
      },
      {
        id: 'q-8-5',
        moduleId: 'module-8',
        type: 'scenario',
        scenario: 'You need to calculate % of Total Sales—each region\'s sales divided by all sales regardless of region filter.',
        question: 'What DAX pattern should you use?',
        points: 6,
        options: [
          'DIVIDE([Total Sales], SUM(Sales))',
          'DIVIDE([Total Sales], CALCULATE([Total Sales], ALL(Region)))',
          'DIVIDE([Total Sales], [Total Sales])',
          '[Total Sales] / 100',
        ],
        correctAnswer: 'DIVIDE([Total Sales], CALCULATE([Total Sales], ALL(Region)))',
        explanation: 'ALL() removes the region filter to get the grand total. DIVIDE handles divide-by-zero safely.',
      },
      {
        id: 'q-8-6',
        moduleId: 'module-8',
        type: 'multiple-choice',
        question: 'What does ALLSELECTED() do?',
        points: 5,
        options: [
          'Selects all columns',
          'Removes visual filter but respects slicer filters',
          'Selects visible rows only',
          'Applies to all visuals',
        ],
        correctAnswer: 'Removes visual filter but respects slicer filters',
        explanation: 'ALLSELECTED is nuanced—it removes some filters while keeping others, useful for dynamic calculations.',
      },
      {
        id: 'q-8-7',
        moduleId: 'module-8',
        type: 'multiple-choice',
        question: 'What is Context Transition?',
        points: 6,
        options: [
          'Converting row context to filter context',
          'Switching between measures',
          'Changing table relationships',
          'Updating data sources',
        ],
        correctAnswer: 'Converting row context to filter context',
        explanation: 'CALCULATE inside a calculated column performs context transition, converting row values to filters.',
      },
      {
        id: 'q-8-8',
        moduleId: 'module-8',
        type: 'true-false',
        question: 'Visual Calculations (GA Oct 2025) allow you to add calculations directly on a visual without writing DAX measures.',
        points: 4,
        correctAnswer: 'true',
        explanation: 'Visual Calculations is a new feature that simplifies adding calculations like running totals to visuals.',
      },
    ],
  },

  // Module 9: Time Intelligence
  {
    id: 'module-9-assessment',
    title: 'Module 9: Time Intelligence Assessment',
    description: 'Test your understanding of time-based calculations',
    quizType: 'module',
    associatedId: 'module-9',
    passingScore: 75,
    timeLimit: 30,
    allowRetake: true,
    questions: [
      {
        id: 'q-9-1',
        moduleId: 'module-9',
        type: 'multiple-choice',
        question: 'What is the prerequisite for using DAX Time Intelligence functions?',
        points: 5,
        options: [
          'SQL Server connection',
          'A properly formatted Date table marked as Date table',
          'DirectQuery mode',
          'No prerequisite needed',
        ],
        correctAnswer: 'A properly formatted Date table marked as Date table',
        explanation: 'Time Intelligence functions require a dedicated, properly formatted Date table.',
      },
      {
        id: 'q-9-2',
        moduleId: 'module-9',
        type: 'multiple-choice',
        question: 'What does YTD stand for in DAX?',
        points: 3,
        options: [
          'Yes That\'s Definitive',
          'Year-to-Date',
          'Yesterday To Date',
          'Y-axis Trend Data',
        ],
        correctAnswer: 'Year-to-Date',
        explanation: 'YTD is a common business calculation for running totals from the beginning of the year.',
      },
      {
        id: 'q-9-3',
        moduleId: 'module-9',
        type: 'fill-blank',
        question: 'Complete this Time Intelligence measure: Sales YTD = _____([Total Sales], \'Date\'[Date])',
        points: 5,
        placeholder: 'Enter function name...',
        correctAnswer: 'totalytd',
        explanation: 'TOTALYTD calculates year-to-date totals.',
      },
      {
        id: 'q-9-4',
        moduleId: 'module-9',
        type: 'multiple-choice',
        question: 'What does SAMEPERIODLASTYEAR() do?',
        points: 5,
        options: [
          'Returns the same date range last year',
          'Calculates year-over-year growth',
          'Marks a date as year-end',
          'Creates a calendar table',
        ],
        correctAnswer: 'Returns the same date range last year',
        explanation: 'SAMEPERIODLASTYEAR returns the equivalent period from the previous year, commonly used for comparisons.',
      },
      {
        id: 'q-9-5',
        moduleId: 'module-9',
        type: 'scenario',
        scenario: 'You need to calculate Sales vs. Sales from Last Year, then calculate the % difference.',
        question: 'What is the correct DAX pattern?',
        points: 6,
        options: [
          'Sales YoY = [Total Sales] - [Sales Last Year]',
          'Sales YoY % = DIVIDE(([Total Sales] - [Sales PY]), [Sales PY])',
          'Sales YoY = TOTALYTD + SAMEPERIODLASTYEAR',
          'Sales YoY = [Total Sales] / 2',
        ],
        correctAnswer: 'Sales YoY % = DIVIDE(([Total Sales] - [Sales PY]), [Sales PY])',
        explanation: 'Build measures incrementally: current, prior year, then YoY difference using DIVIDE for safety.',
      },
      {
        id: 'q-9-6',
        moduleId: 'module-9',
        type: 'true-false',
        question: 'Rolling averages require complex DAX with DATESINPERIOD inside CALCULATE.',
        points: 5,
        correctAnswer: 'true',
        explanation: 'Rolling averages need DATESINPERIOD to define the period window, used with CALCULATE for filtering.',
      },
    ],
  },

  // Module 10: Report Design
  {
    id: 'module-10-assessment',
    title: 'Module 10: Report Design Assessment',
    description: 'Test your understanding of effective visualization and storytelling',
    quizType: 'module',
    associatedId: 'module-10',
    passingScore: 75,
    timeLimit: 30,
    allowRetake: true,
    questions: [
      {
        id: 'q-10-1',
        moduleId: 'module-10',
        type: 'multiple-choice',
        question: 'What visual is best for showing categorical comparisons?',
        points: 4,
        options: [
          'Line chart',
          'Bar/Column chart',
          'Pie chart',
          'Gauge',
        ],
        correctAnswer: 'Bar/Column chart',
        explanation: 'Bar charts excel at comparing values across categories.',
      },
      {
        id: 'q-10-2',
        moduleId: 'module-10',
        type: 'multiple-choice',
        question: 'What is the recommended placement for the most important information in a report?',
        points: 5,
        options: [
          'Bottom-right corner',
          'Center of the page',
          'Top-left using visual hierarchy',
          'Randomly distributed',
        ],
        correctAnswer: 'Top-left using visual hierarchy',
        explanation: 'Users read in a "Z" pattern, so key information should be top-left.',
      },
      {
        id: 'q-10-3',
        moduleId: 'module-10',
        type: 'multiple-choice',
        question: 'What is Drill-through used for?',
        points: 5,
        options: [
          'Exporting reports',
          'Navigating from a summary visual to a detailed, filtered page',
          'Zooming in on a visual',
          'Creating new visuals',
        ],
        correctAnswer: 'Navigating from a summary visual to a detailed, filtered page',
        explanation: 'Drill-through right-clicks a data point to jump to a pre-filtered detail page.',
      },
      {
        id: 'q-10-4',
        moduleId: 'module-10',
        type: 'multiple-choice',
        question: 'What feature captures and saves report state including filters and slicers?',
        points: 4,
        options: [
          'Bookmarks',
          'Export',
          'Themes',
          'Navigation',
        ],
        correctAnswer: 'Bookmarks',
        explanation: 'Bookmarks save current state for creating guided narratives and app-like experiences.',
      },
      {
        id: 'q-10-5',
        moduleId: 'module-10',
        type: 'multiple-choice',
        question: 'What is the purpose of Custom Report Tooltips?',
        points: 5,
        options: [
          'To hide visuals',
          'To create miniature report pages that appear on hover',
          'To export data',
          'To add animations',
        ],
        correctAnswer: 'To create miniature report pages that appear on hover',
        explanation: 'Custom tooltips are small, interactive report pages providing context without cluttering the main view.',
      },
      {
        id: 'q-10-6',
        moduleId: 'module-10',
        type: 'true-false',
        question: 'Effective data storytelling requires: Context → Finding → Why → Action.',
        points: 5,
        correctAnswer: 'true',
        explanation: 'A compelling narrative guides users through context, key findings, root causes, and recommended actions.',
      },
    ],
  },

  // Module 11: AI Visuals & Insights
  {
    id: 'module-11-assessment',
    title: 'Module 11: AI Visuals Assessment',
    description: 'Test your understanding of Power BI\'s AI capabilities',
    quizType: 'module',
    associatedId: 'module-11',
    passingScore: 70,
    timeLimit: 25,
    allowRetake: true,
    questions: [
      {
        id: 'q-11-1',
        moduleId: 'module-11',
        type: 'multiple-choice',
        question: 'What is the Key Influencers visual used for?',
        points: 5,
        options: [
          'To show top performing products',
          'To understand what factors drive a specific metric',
          'To calculate forecasts',
          'To create drill-downs',
        ],
        correctAnswer: 'To understand what factors drive a specific metric',
        explanation: 'Key Influencers analyzes which factors influence an outcome (e.g., what drives high profit).',
      },
      {
        id: 'q-11-2',
        moduleId: 'module-11',
        type: 'multiple-choice',
        question: 'What is the Decomposition Tree used for?',
        points: 5,
        options: [
          'To show sales over time',
          'To perform ad-hoc root-cause analysis by breaking down measures',
          'To create KPIs',
          'To filter data',
        ],
        correctAnswer: 'To perform ad-hoc root-cause analysis by breaking down measures',
        explanation: 'Decomposition Tree lets users dynamically drill down to find the source of variance.',
      },
      {
        id: 'q-11-3',
        moduleId: 'module-11',
        type: 'multiple-choice',
        question: 'Which built-in features can be added to line charts?',
        points: 5,
        options: [
          'Color coding',
          'Anomaly Detection and Forecasting',
          'Drill-through',
          'Slicers',
        ],
        correctAnswer: 'Anomaly Detection and Forecasting',
        explanation: 'Line charts support AI-powered anomaly detection and time-series forecasting.',
      },
      {
        id: 'q-11-4',
        moduleId: 'module-11',
        type: 'true-false',
        question: 'Anomaly Detection automatically identifies unexpected spikes or dips in time-series data.',
        points: 4,
        correctAnswer: 'true',
        explanation: 'Anomaly Detection uses AI to flag unusual patterns without manual threshold setting.',
      },
    ],
  },

  // Module 12: Power BI Service
  {
    id: 'module-12-assessment',
    title: 'Module 12: Power BI Service Assessment',
    description: 'Test your understanding of cloud collaboration and deployment',
    quizType: 'module',
    associatedId: 'module-12',
    passingScore: 70,
    timeLimit: 30,
    allowRetake: true,
    questions: [
      {
        id: 'q-12-1',
        moduleId: 'module-12',
        type: 'multiple-choice',
        question: 'What are the three main content types in Power BI Service?',
        points: 5,
        options: [
          'Reports, Datasets, Workspaces',
          'Reports, Dashboards, Semantic Models',
          'Visuals, Filters, Slicers',
          'Desktop, Service, Mobile',
        ],
        correctAnswer: 'Reports, Dashboards, Semantic Models',
        explanation: 'Semantic Models is the new name for Datasets in Power BI Service.',
      },
      {
        id: 'q-12-2',
        moduleId: 'module-12',
        type: 'multiple-choice',
        question: 'What is the key difference between Reports and Dashboards?',
        points: 6,
        options: [
          'Reports are in Desktop, Dashboards in Service',
          'Reports are interactive multi-page; Dashboards are single-page monitoring',
          'They are identical',
          'Dashboards have DAX, Reports do not',
        ],
        correctAnswer: 'Reports are interactive multi-page; Dashboards are single-page monitoring',
        explanation: 'Reports = deep analysis. Dashboards = at-a-glance monitoring.',
      },
      {
        id: 'q-12-3',
        moduleId: 'module-12',
        type: 'multiple-choice',
        question: 'What is the correct distribution method for end-users?',
        points: 5,
        options: [
          'Share the workspace directly',
          'Publish content as an App',
          'Export to Excel',
          'Email screenshots',
        ],
        correctAnswer: 'Publish content as an App',
        explanation: 'Apps provide a clean, curated experience for consumers, hiding backend complexity.',
      },
      {
        id: 'q-12-4',
        moduleId: 'module-12',
        type: 'multiple-choice',
        question: 'What is an On-Premises Data Gateway used for?',
        points: 5,
        options: [
          'To host Power BI Desktop',
          'To allow Power BI Service to refresh on-premises data',
          'To backup reports',
          'To improve performance',
        ],
        correctAnswer: 'To allow Power BI Service to refresh on-premises data',
        explanation: 'Gateway acts as a secure tunnel for cloud Service to reach on-premises data sources.',
      },
      {
        id: 'q-12-5',
        moduleId: 'module-12',
        type: 'true-false',
        question: 'Pro licenses allow up to 8 refreshes per day; Premium allows up to 48.',
        points: 4,
        correctAnswer: 'true',
        explanation: 'Refresh frequency is limited by license type, with Premium offering more frequent refresh.',
      },
    ],
  },

  // Module 13: Performance Tuning
  {
    id: 'module-13-assessment',
    title: 'Module 13: Performance Tuning Assessment',
    description: 'Test your understanding of optimization strategies',
    quizType: 'module',
    associatedId: 'module-13',
    passingScore: 75,
    timeLimit: 30,
    allowRetake: true,
    questions: [
      {
        id: 'q-13-1',
        moduleId: 'module-13',
        type: 'multiple-choice',
        question: 'What tool should you use to identify which visual is slow?',
        points: 4,
        options: [
          'DAX Studio',
          'Performance Analyzer',
          'Tabular Editor',
          'SQL Profiler',
        ],
        correctAnswer: 'Performance Analyzer',
        explanation: 'Performance Analyzer identifies which visual is slow; DAX Studio shows why.',
      },
      {
        id: 'q-13-2',
        moduleId: 'module-13',
        type: 'multiple-choice',
        question: 'What tool shows why a DAX query is slow?',
        points: 4,
        options: [
          'Performance Analyzer',
          'DAX Studio',
          'Report Analyzer',
          'Query Builder',
        ],
        correctAnswer: 'DAX Studio',
        explanation: 'DAX Studio provides deep analysis of DAX query performance with engine timings.',
      },
      {
        id: 'q-13-3',
        moduleId: 'module-13',
        type: 'multiple-choice',
        question: 'What is the highest priority optimization strategy?',
        points: 5,
        options: [
          'Write better DAX',
          'Build a proper Star Schema data model',
          'Reduce visual count',
          'Use DirectQuery',
        ],
        correctAnswer: 'Build a proper Star Schema data model',
        explanation: 'Data model optimization has the biggest performance impact—it\'s foundational.',
      },
      {
        id: 'q-13-4',
        moduleId: 'module-13',
        type: 'multiple-choice',
        question: 'What are Aggregations used for?',
        points: 5,
        options: [
          'Grouping visuals',
          'Pre-summarizing large fact tables for better performance',
          'Organizing columns',
          'Importing data',
        ],
        correctAnswer: 'Pre-summarizing large fact tables for better performance',
        explanation: 'Aggregations pre-calculate summaries while maintaining detail on drill-down.',
      },
      {
        id: 'q-13-5',
        moduleId: 'module-13',
        type: 'multiple-choice',
        question: 'What is Incremental Refresh?',
        points: 5,
        options: [
          'Partial data refresh over time',
          'Only refreshing data that changed',
          'Cancelling slow refreshes',
          'Automatic refresh scheduling',
        ],
        correctAnswer: 'Only refreshing data that changed',
        explanation: 'Incremental refresh only updates new data, drastically reducing refresh times.',
      },
      {
        id: 'q-13-6',
        moduleId: 'module-13',
        type: 'true-false',
        question: 'Performance Analyzer is now available in Power BI Service (GA Oct 2025).',
        points: 4,
        correctAnswer: 'true',
        explanation: 'You can now test performance directly in production Service environment.',
      },
    ],
  },

  // Module 14: Governance & Security
  {
    id: 'module-14-assessment',
    title: 'Module 14: Governance & Security Assessment',
    description: 'Test your understanding of RLS, OLS, and governance',
    quizType: 'module',
    associatedId: 'module-14',
    passingScore: 75,
    timeLimit: 30,
    allowRetake: true,
    questions: [
      {
        id: 'q-14-1',
        moduleId: 'module-14',
        type: 'multiple-choice',
        question: 'What is Row-Level Security (RLS) used for?',
        points: 5,
        options: [
          'Controlling visual access',
          'Restricting data at the row level based on user identity',
          'Limiting report size',
          'Performance optimization',
        ],
        correctAnswer: 'Restricting data at the row level based on user identity',
        explanation: 'RLS ensures users only see data they are authorized to see.',
      },
      {
        id: 'q-14-2',
        moduleId: 'module-14',
        type: 'multiple-choice',
        question: 'What is the most scalable RLS approach?',
        points: 6,
        options: [
          'Static RLS with one role per region',
          'Dynamic RLS with a user permissions table',
          'Workspace permissions only',
          'Report-level filters',
        ],
        correctAnswer: 'Dynamic RLS with a user permissions table',
        explanation: 'Dynamic RLS scales by simply adding rows to a permissions table.',
      },
      {
        id: 'q-14-3',
        moduleId: 'module-14',
        type: 'multiple-choice',
        question: 'What is Object-Level Security (OLS) used for?',
        points: 5,
        options: [
          'Hiding rows of data',
          'Hiding entire columns or tables',
          'Controlling workspace access',
          'Preventing data export',
        ],
        correctAnswer: 'Hiding entire columns or tables',
        explanation: 'OLS hides specific columns or tables from certain roles.',
      },
      {
        id: 'q-14-4',
        moduleId: 'module-14',
        type: 'multiple-choice',
        question: 'Where can Object-Level Security (OLS) be configured?',
        points: 5,
        options: [
          'In Power BI Desktop Options',
          'In Power BI Service settings',
          'Using Tabular Editor',
          'Using DAX Studio',
        ],
        correctAnswer: 'Using Tabular Editor',
        explanation: 'OLS requires external tools like Tabular Editor; it\'s not in Desktop UI.',
      },
      {
        id: 'q-14-5',
        moduleId: 'module-14',
        type: 'multiple-choice',
        question: 'What does the DAX filter Region = "East" do in RLS?',
        points: 4,
        options: [
          'Shows all East region sales',
          'Hides all East region data',
          'Limits data to current user\'s region',
          'Creates an East region role',
        ],
        correctAnswer: 'Shows all East region sales',
        explanation: 'RLS filters limit which rows users can see—this shows only East.',
      },
      {
        id: 'q-14-6',
        moduleId: 'module-14',
        type: 'true-false',
        question: 'Dynamic RLS uses USERPRINCIPALNAME() to identify the logged-in user.',
        points: 5,
        correctAnswer: 'true',
        explanation: 'USERPRINCIPALNAME() returns the current user\'s email address for dynamic filtering.',
      },
    ],
  },

  // Module 15: Advanced Data Modeling
  {
    id: 'module-15-assessment',
    title: 'Module 15: Advanced Data Modeling Assessment',
    description: 'Test your mastery of advanced modeling techniques',
    quizType: 'module',
    associatedId: 'module-15',
    passingScore: 70,
    timeLimit: 25,
    allowRetake: true,
    questions: [
      {
        id: 'q-15-1',
        moduleId: 'module-15',
        type: 'multiple-choice',
        question: 'What is Tabular Editor primarily used for?',
        points: 5,
        options: [
          'Writing DAX queries',
          'Advanced data modeling and managing model metadata',
          'Creating visuals',
          'Exporting reports',
        ],
        correctAnswer: 'Advanced data modeling and managing model metadata',
        explanation: 'Tabular Editor exposes modeling features not available in Desktop UI.',
      },
      {
        id: 'q-15-2',
        moduleId: 'module-15',
        type: 'multiple-choice',
        question: 'What are Calculation Groups used for?',
        points: 6,
        options: [
          'Grouping multiple tables',
          'Creating reusable calculations that apply to any base measure',
          'Organizing visuals',
          'Merging queries',
        ],
        correctAnswer: 'Creating reusable calculations that apply to any base measure',
        explanation: 'Calculation Groups are "measures for measures"—reusable logic like time intelligence.',
      },
      {
        id: 'q-15-3',
        moduleId: 'module-15',
        type: 'multiple-choice',
        question: 'What function acts as a placeholder for the current measure in Calculation Groups?',
        points: 5,
        options: [
          'SELECTEDVALUE',
          'SELECTEDMEASURE',
          'CURRENTMEASURE',
          'ACTIVEMEASURE',
        ],
        correctAnswer: 'SELECTEDMEASURE',
        explanation: 'SELECTEDMEASURE references whatever base measure is in context.',
      },
      {
        id: 'q-15-4',
        moduleId: 'module-15',
        type: 'multiple-choice',
        question: 'What is a Dataflow (Gen2) used for?',
        points: 5,
        options: [
          'To refresh reports',
          'To create cloud-based ETL that stores data in Fabric',
          'To export reports',
          'To create visuals',
        ],
        correctAnswer: 'To create cloud-based ETL that stores data in Fabric',
        explanation: 'Dataflows Gen2 is "Power Query in the cloud" integrated with Microsoft Fabric.',
      },
      {
        id: 'q-15-5',
        moduleId: 'module-15',
        type: 'true-false',
        question: 'Calculation Groups can reduce dozens of measures to one base measure plus a calculation group.',
        points: 5,
        correctAnswer: 'true',
        explanation: 'This dramatically simplifies models and improves maintainability.',
      },
    ],
  },

  // Module 16: Enterprise Deployment
  {
    id: 'module-16-assessment',
    title: 'Module 16: Enterprise Deployment Assessment',
    description: 'Test your understanding of CI/CD and Fabric',
    quizType: 'module',
    associatedId: 'module-16',
    passingScore: 70,
    timeLimit: 30,
    allowRetake: true,
    questions: [
      {
        id: 'q-16-1',
        moduleId: 'module-16',
        type: 'multiple-choice',
        question: 'What are Deployment Pipelines used for?',
        points: 6,
        options: [
          'Managing report versions',
          'Automating CI/CD process for safe deployments',
          'Importing data',
          'Creating visuals',
        ],
        correctAnswer: 'Automating CI/CD process for safe deployments',
        explanation: 'Pipelines enable DEV → TEST → PROD workflow to prevent breaking changes.',
      },
      {
        id: 'q-16-2',
        moduleId: 'module-16',
        type: 'multiple-choice',
        question: 'What is Microsoft Fabric\'s central concept?',
        points: 5,
        options: [
          'Power BI Premium',
          'OneLake—a unified data lake for all tools',
          'Azure SQL',
          'Power Apps',
        ],
        correctAnswer: 'OneLake—a unified data lake for all tools',
        explanation: 'OneLake is the "OneDrive for Data" eliminating silos and duplication.',
      },
      {
        id: 'q-16-3',
        moduleId: 'module-16',
        type: 'multiple-choice',
        question: 'What does the typical Deployment Pipeline flow look like?',
        points: 5,
        options: [
          'PROD → TEST → DEV',
          'DEV → TEST → PROD',
          'TEST → DEV → PROD',
          'Any order works',
        ],
        correctAnswer: 'DEV → TEST → PROD',
        explanation: 'Develop, test, then deploy to production—standard CI/CD flow.',
      },
      {
        id: 'q-16-4',
        moduleId: 'module-16',
        type: 'multiple-choice',
        question: 'What is Power BI Embedded Analytics used for?',
        points: 6,
        options: [
          'Embedding Power BI inside custom applications for external customers',
          'Creating mobile apps',
          'Backing up reports',
          'Exporting to PDF',
        ],
        correctAnswer: 'Embedding Power BI inside custom applications for external customers',
        explanation: 'Embedded enables white-label BI in your own SaaS applications.',
      },
      {
        id: 'q-16-5',
        moduleId: 'module-16',
        type: 'true-false',
        question: 'Microsoft Fabric unifies Data Engineering, Warehousing, and BI into a single SaaS platform.',
        points: 5,
        correctAnswer: 'true',
        explanation: 'Fabric is Microsoft\'s unified analytics platform bringing all tools together.',
      },
    ],
  },

  // Module 17: Copilot & Fabric Mastery
  {
    id: 'module-17-assessment',
    title: 'Module 17: Copilot & Fabric Assessment',
    description: 'Test your understanding of 2025 AI features',
    quizType: 'module',
    associatedId: 'module-17',
    passingScore: 70,
    timeLimit: 25,
    allowRetake: true,
    questions: [
      {
        id: 'q-17-1',
        moduleId: 'module-17',
        type: 'multiple-choice',
        question: 'What is Copilot in Power BI used for?',
        points: 5,
        options: [
          'To backup reports',
          'AI-powered assistance for generating insights and DAX',
          'To export data',
          'To create visuals only',
        ],
        correctAnswer: 'AI-powered assistance for generating insights and DAX',
        explanation: 'Copilot provides AI assistance for analysis, DAX generation, and reporting.',
      },
      {
        id: 'q-17-2',
        moduleId: 'module-17',
        type: 'multiple-choice',
        question: 'What is DAX Query View used for with Copilot?',
        points: 5,
        options: [
          'To view table data',
          'To write and test DAX queries with AI assistance',
          'To export reports',
          'To create relationships',
        ],
        correctAnswer: 'To write and test DAX queries with AI assistance',
        explanation: 'DAX Query View with Copilot can generate and explain DAX code from natural language.',
      },
      {
        id: 'q-17-3',
        moduleId: 'module-17',
        type: 'multiple-choice',
        question: 'What is a OneLake Shortcut used for?',
        points: 5,
        options: [
          'To create bookmarks',
          'To link Power BI directly to Fabric data without movement',
          'To export reports',
          'To backup data',
        ],
        correctAnswer: 'To link Power BI directly to Fabric data without movement',
        explanation: 'Shortcuts enable direct access to Fabric Lakehouse data without duplication.',
      },
      {
        id: 'q-17-4',
        moduleId: 'module-17',
        type: 'true-false',
        question: 'Copilot can generate complete multi-page reports from natural language prompts.',
        points: 4,
        correctAnswer: 'true',
        explanation: 'Copilot\'s report builder can create full reports from high-level descriptions.',
      },
    ],
  },

  // Module 18: Certification & Career
  {
    id: 'module-18-assessment',
    title: 'Module 18: Certification & Career Assessment',
    description: 'Test your understanding of PL-300 and career paths',
    quizType: 'module',
    associatedId: 'module-18',
    passingScore: 70,
    timeLimit: 25,
    allowRetake: true,
    questions: [
      {
        id: 'q-18-1',
        moduleId: 'module-18',
        type: 'multiple-choice',
        question: 'What is the official Microsoft Power BI certification exam?',
        points: 4,
        options: [
          'PL-200',
          'PL-300',
          'DAX-100',
          'BI-501',
        ],
        correctAnswer: 'PL-300',
        explanation: 'PL-300: Microsoft Power BI Data Analyst is the official certification.',
      },
      {
        id: 'q-18-2',
        moduleId: 'module-18',
        type: 'multiple-choice',
        question: 'What are the four main domains of the PL-300 exam?',
        points: 6,
        options: [
          'DAX, Reports, Power Query, Service',
          'Prepare Data, Model Data, Visualize Data, Deploy & Maintain',
          'Desktop, Mobile, Service, Gateway',
          'SQL, Python, R, JavaScript',
        ],
        correctAnswer: 'Prepare Data, Model Data, Visualize Data, Deploy & Maintain',
        explanation: 'PL-300 covers the complete data analyst workflow.',
      },
      {
        id: 'q-18-3',
        moduleId: 'module-18',
        type: 'multiple-choice',
        question: 'What is the most important skill for staying current with Power BI?',
        points: 5,
        options: [
          'Memorizing all functions',
          'Learning how to learn—using monthly updates and resources',
          'Taking many certifications',
          'Reading only official docs',
        ],
        correctAnswer: 'Learning how to learn—using monthly updates and resources',
        explanation: 'Power BI changes monthly—continuous learning is essential.',
      },
      {
        id: 'q-18-4',
        moduleId: 'module-18',
        type: 'true-false',
        question: 'The three capstone projects and PL-300 badge should be featured on your LinkedIn profile.',
        points: 4,
        correctAnswer: 'true',
        explanation: 'Showcase practical work and certifications to attract employers.',
      },
    ],
  },
]

// Helper function to get quiz by ID
export function getQuizById(quizId: string): Quiz | undefined {
  return quizData.find(q => q.id === quizId)
}

// Helper function to get quizzes by module
export function getQuizzesByModule(moduleId: string): Quiz[] {
  return quizData.filter(q => q.associatedId === moduleId)
}

// Helper function to get all module quizzes
export function getAllModuleQuizzes(): Quiz[] {
  return quizData.filter(q => q.quizType === 'module')
}

// Helper function to get lessons with quizzes
export function getLessonsWithQuizzes(): string[] {
  // This would be expanded as lesson-specific quizzes are added
  return []
}

// Helper function to get module assessment by module number
export function getModuleAssessment(moduleNumber: number): Quiz | undefined {
  return quizData.find(q => q.id === `module-${moduleNumber}-assessment`)
}

// Helper function to get PL-300 Mock Exam
export function getPL300MockExam(): Quiz | undefined {
  return quizData.find(q => q.id === 'pl300-mock-exam')
}

// Helper function to get all assessments (module + mock exam)
export function getAllAssessments(): Quiz[] {
  return quizData.filter(q => q.quizType === 'module' || q.quizType === 'mock-exam')
}

